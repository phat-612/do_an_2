<form action="/api/updateProduct" method="post">
   <input type="text" value="{{product._id}}" name="id" hidden>
  <div class="container">
   {{!-- {{#each variations}}
   <h2>{{this.price}}</h2>
   {{/each}} --}}
    <label for="name-Product" class="form-label fs-4">Tên Sản phẩm</label>
   
    <input type="text" class="form-control" id="name-Product" value="{{product.name}}" name="name" />
    <label for="description-Product" class="col-form-label fs-4">Mô Tả Sản Phẩm</label>
    <textarea class="form-control" id="description-Product" name="description">{{product.description}}</textarea>
    <label for="categoryDataList" class="form-label fs-4">Danh Mục</label>
    <select class="form-control" name="idCategory" id="">
      <option value="">Chọn Danh Mục</option>
      {{#each categorys}}
        <option value="{{this._id}}" {{isSelectedObejctId ../product.idCategory this._id}} >{{this.name}}</option>
      {{/each}}
    </select>
   {{!-- -------------------------------- --}}
      <label for="brandDataList" class="form-label fs-4 mt-3">Thuộc Tính</label>
      <div class="w-75 container-sm py-4 my-4 border rounded">
         <div class="row">
            <div class="col-md-6">
               <label for="ipNameAttributePro1" class="form-label fs-5">Nhập Tên Thuộc tính</label>
            </div>
            <div class="col-md-6">
               <input type="text" id="inpNameAttributePro1" class="form-control variations" value="{{#each product.variations}}{{#if @first}}{{#each this.attributes}}{{#if @first}}{{@key}}{{/if}}{{/each}}{{/if}}{{/each}}">
            </div>
            <div class="col-md-6 my-3">
               <label for="" class="form-label fs-5">Nhập Thuộc Tính</label>
            </div>
            <div class="col-md-6 my-3" id="inputAttribute1Div">
               <button type="button" class="btn btn-success form-control addAttribute1-btn">Thêm Thuộc Tính</button>
               {{#each attributes1}}
                  {{#if @first}}
                     {{#each this}}
                        <div class="row">
                           <input type="text" id="thuocTinh1" class="form-control my-2 col variations thuocTinh1" value="{{this}}">
                           <button type="button" class="btn btn-danger col-2 my-2" onclick="deleteAttribute(event)">Xóa</button>
                        </div>
                     {{/each}}
                  {{/if}}
               {{/each}}
            </div>
         </div>
     </div>
     {{!-- =============================== --}}
     <div class="w-75 container-sm py-4 my-4 border rounded Attribute2div">
      <div class="row">
         <div class="col-md-6">
            <label for="inpNameAttributePro2" class="form-label fs-5">Nhập Tên Thuộc Tính</label>
         </div>
         <div class="col-md-6">
            <input type="text" id="inpNameAttributePro2" class="form-control variations" value="{{#each product.variations}}{{#if @first}}{{#each this.attributes}}{{#if @last}}{{@key}}{{/if}}{{/each}}{{/if}}{{/each}}">
         </div>
         <div class="col-md-6 my-3">
            <label for="" class="form-label fs-5">Nhập Thuộc Tính</label>
         </div>
         <div class="col-md-6 my-3" id="inputAttribute2Div">
            <button type="button" class="btn btn-success form-control addAttribute2-btn">Thêm Thuộc Tính</button>
               {{#each attributes2}}
                  {{#if @first}}
                     {{#each this}}
                        <div class="row"> 
                           <input type="text" id="thuocTinh1" class="form-control my-2 col variations thuocTinh2" value="{{this}}">
                           <button type="button" class="btn btn-danger col-2 my-2" onclick="deleteAttribute(event)">Xóa</button>
                        </div>
                     {{/each}}
                  {{/if}}
               {{/each}}
         </div>
      </div>
     </div>
     {{!-- ------------------------- --}}
    <table id="custom-varriant" class="table-based table">
         <thead>
            <tr>
               <th class="col-3 th1">{{#each product.variations}}{{#if @first}}{{#each this.attributes}}{{#if @first}}{{@key}}{{/if}}{{/each}}{{/if}}{{/each}}</th>
               <th class="col-3 th2">{{#each product.variations}}{{#if @first}}{{#each this.attributes}}{{#if @last}}{{@key}}{{/if}}{{/each}}{{/if}}{{/each}}</th>
               <th class="col-3">Giá</th>
               <th class="col-3">Số lượng</th>
            </tr>
         </thead>
         <tbody>
            {{#each product.variations}}
               <tr data-bs-id="{{this._id}}" data-bs-sold="{{this.sold}}">
                  <td class="td1">{{#each this.attributes}}{{#if
                        @first
                     }}{{this}}{{/if}}{{/each}}<input type="text" class="tdAttribute1" value="{{#each this.attributes}}{{#if
                        @first
                     }}{{this}}{{/if}}{{/each}}" required hidden></td>
                  <td class="td2">{{#each this.attributes}}{{#if
                        @last
                     }}{{this}}{{/if}}{{/each}}<input type="text" class="tdAttribute2" value="{{#each this.attributes}}{{#if
                        @last
                     }}{{this}}{{/if}}{{/each}}" required hidden></td>
                  <td><input type="number" class="form-control tdPrice" value="{{this.price}}" ></td>
                  <td><input type="number" class="form-control tdQuantity" value="{{this.quantity}}"></td>
               </tr>
            {{/each}}
         </tbody>
      </table>
      {{!-- ------------------------- --}}
      <div class="row w-75 my-4"> 
         <div class="col">
            <label for="" class="form-label fs-5">Nhập số phần trăm giảm :</label>
            <div class="input-group">
               <input type="number" name="discount[percent]" id="percentInput" class="form-control" max="100" min="0" oninput="this.value = Math.abs(this.value)" value="{{product.discount.percent}}">
               <span class="input-group-text">%</span>
            </div>
         </div>
         <div class="col">
            <label for="discountStart" class="form-label fs-5">Ngày bắt đầu :</label>
            <input type="date" name="discount[startDay]" id="discountStart" class="form-control" value="{{formatDate product.discount.startDay "YYYY-MM-DD"}}" disabled>
         </div>
         <div class="col">
            <label for="discountEnd" class="form-label fs-5">Ngày kết thúc :</label>
            <input type="date" name="discount[endDay]" id="discountEnd" class="form-control" value="{{formatDate product.discount.endDay "YYYY-MM-DD"}}" disabled>
         </div>
      </div>
     {{!-- ------------------------- --}}
      <div class="mb-3">
         <label for="multiImageUpload" class="form-label fs-4">Tải Ảnh Lên (TỐI ĐA 8 ẢNH)</label>
         <input
            type="file"
            class="form-control"
            id="multiImageUpload"
            accept="image/*"
            multiple
            name="images"
            value=""
            data-bs-datas="{{#each product.images}}{{this}} {{/each}}"
            />
      </div>
      <div class="mb-3">
         <p>Danh sách Ảnh :</p>
         <div id="multiImagePreview" class="row">
            {{#each product.images}}
               <img src="/img/uploads/{{this}}" name="images[{{this}}]" alt="" class="col-3" />
            {{/each}}
         </div>
      </div>

      <div class="d-flex flex-row-reverse bd-highlight">
      <button type="submit" class="btn btn-success mb-4 submitbtn">LƯU SẢN PHẨM</button>
    </div>
  </div>

</form>

